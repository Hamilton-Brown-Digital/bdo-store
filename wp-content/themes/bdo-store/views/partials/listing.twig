
{% set posts = Post(acf.listing_cards) %}

<div class="c-listing">

<div class="o-row">
        <div class="o-grid-container">

        <div class="c-listing__subhead">
            {{ acf.listing_subhead }}
        </div>

        <div class="c-listing__heading">
            {{ acf.listing_heading }}
        </div>

        <div class="c-listing__grid--{{ acf.listing_columns }}">




        {% for card in posts %}

        <div class="c-listing__card">

            {% set type = card.post_type %}

            {% set cardItems = {
                type: type,
                title: card.title,
                url: card.link,
                excerpt: card.preview.read_more('')
            } %}

            {% if type == 'page' %}
                {% if card.product_category %}
                    {% set cardItems = cardItems|merge({
                        productCount: TimberTerm(card.product_category).posts()|length,
                        color: TimberTerm(card.product_category).colour
                    })%}
                {% endif %}
            {% endif %}

            {% if type == 'product' %}
                {% set cardItems = cardItems|merge({
                    price: card._price,
                    terms: card.terms( {query:{taxonomy:'product_cat'}} )|join(', '),
                    color: card.terms( {query:{taxonomy:'product_cat'}} )[0].colour
                })%}
            {% endif %}

            {% include "./elements/card.twig" with cardItems %}

            </div>

        {% endfor %}

        </div>

        </div>
</div>

</div>